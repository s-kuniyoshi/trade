# FXè‡ªå‹•å£²è²·ã‚·ã‚¹ãƒ†ãƒ  è¨­è¨ˆæ›¸
## äºˆæ¸¬ç²¾åº¦é‡è¦–ãƒ»24/365è‡ªå‹•é‹ç”¨

---

## 1. ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

### 1.1 ç›®æ¨™
- **äºˆæ¸¬ç²¾åº¦ã‚’æœ€å„ªå…ˆ**ã—ã€å–å¼•å›æ•°ã‚’çµã£ã¦ã€Œæ¡ä»¶ãŒè‰¯ã„æ™‚ã ã‘ã€å–å¼•
- **24æ™‚é–“365æ—¥**ã®å®Œå…¨è‡ªå‹•é‹ç”¨
- **ä¿å®ˆçš„ãƒªã‚¹ã‚¯ç®¡ç†**ã§æå¤±ã‚’æœ€å°åŒ–ã—ã€å®‰å®šã—ãŸåˆ©ç›Šã‚’è¿½æ±‚

### 1.2 åŸºæœ¬æ–¹é‡

| é …ç›® | æ–¹é‡ |
|------|------|
| é€Ÿåº¦ | ç§’å˜ä½ã®é…å»¶ã¯è¨±å®¹ï¼ˆç²¾åº¦å„ªå…ˆï¼‰ |
| å–å¼•é »åº¦ | å°‘ãªã‚ï¼ˆå³é¸ã•ã‚ŒãŸé«˜ç¢ºä¿¡åº¦å–å¼•ã®ã¿ï¼‰ |
| ãƒªã‚¹ã‚¯ | ã€Œå‹ã¤ã€ã‚ˆã‚Šã€Œæ­»ãªãªã„ã€ã‚’å…ˆã«è¨­è¨ˆ |
| ãƒ¢ãƒ‡ãƒ« | ã¾ãšGBDTã€æ”¹å–„ç¢ºèªå¾Œã«Transformerè¿½åŠ  |

### 1.3 è¦ä»¶

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  | MetaTrader 5 |
| äºˆæ¸¬æ‰‹æ³• | æ©Ÿæ¢°å­¦ç¿’ï¼ˆLightGBM â†’ Transformerï¼‰ |
| é€šè²¨ãƒšã‚¢ | ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒšã‚¢ï¼ˆEUR/USD, USD/JPY, GBP/USDï¼‰ |
| æ™‚é–“è»¸ | ãƒãƒ«ãƒã‚¿ã‚¤ãƒ ãƒ•ãƒ¬ãƒ¼ãƒ ï¼ˆM15, H1, H4, D1ï¼‰ |
| ãƒªã‚¹ã‚¯è¨±å®¹åº¦ | ä¿å®ˆçš„ |
| ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆ | Walk-Forwardå¿…é ˆ |
| é‹ç”¨ç’°å¢ƒ | è‡ªå®…PC |

---

## 2. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### 2.1 ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Market Data                               â”‚
â”‚                    (Broker via MT5)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MT5 Terminal (EA)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  - ç¢ºå®šè¶³ãƒ‡ãƒ¼ã‚¿åé›†                                          â”‚ â”‚
â”‚  â”‚  - æ³¨æ–‡/æ±ºæ¸ˆ/å»ºç‰ç®¡ç†                                        â”‚ â”‚
â”‚  â”‚  - ãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼ï¼ˆDD/é€£æ•—/é€šä¿¡æ–­ã§åœæ­¢ï¼‰                          â”‚ â”‚
â”‚  â”‚  - Pythonã¸ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡ãƒ»ã‚·ã‚°ãƒŠãƒ«å—ä¿¡                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ ZeroMQ / HTTP (localhost)
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Python Inference Service                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Feature Engine   â”‚ Prediction Engine  â”‚ Decision Engine   â”‚  â”‚
â”‚  â”‚ - MTFç‰¹å¾´é‡ç”Ÿæˆ   â”‚ - LightGBMæ¨è«–     â”‚ - ã‚·ã‚°ãƒŠãƒ«ç”Ÿæˆ     â”‚  â”‚
â”‚  â”‚ - æ­£è¦åŒ–ãƒ»æ¬ æå‡¦ç† â”‚ - æœŸå¾…ãƒªã‚¿ãƒ¼ãƒ³äºˆæ¸¬  â”‚ - ä¿¡é ¼åº¦ãƒ•ã‚£ãƒ«ã‚¿   â”‚  â”‚
â”‚  â”‚ - ãƒªãƒ¼ã‚¯é˜²æ­¢      â”‚ - ä¸ç¢ºå®Ÿæ€§æ¨å®š     â”‚ - ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚º  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Risk Manager                             â”‚  â”‚
â”‚  â”‚  - ãƒœãƒ©ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚µã‚¤ã‚¸ãƒ³ã‚° - SL/TPè¨ˆç®— - DDåˆ¶é™ - å–å¼•åœæ­¢   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Supporting Services                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Data Store   â”‚ Trainer      â”‚ Model       â”‚ Monitoring    â”‚  â”‚
â”‚  â”‚ (SQLite/     â”‚ Pipeline     â”‚ Registry    â”‚ & Watchdog    â”‚  â”‚
â”‚  â”‚  Parquet)    â”‚ (é€±æ¬¡WF)     â”‚             â”‚               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè²¬å‹™

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | è²¬å‹™ |
|----------------|------|
| **MT5 EA** | ãƒ‡ãƒ¼ã‚¿åé›†ã€æ³¨æ–‡åŸ·è¡Œã€ã‚»ãƒ¼ãƒ•ã‚¬ãƒ¼ãƒ‰ã€Pythoné€šä¿¡ |
| **Feature Engine** | ç‰¹å¾´é‡ç”Ÿæˆã€MTFçµ±åˆã€å‰å‡¦ç† |
| **Prediction Engine** | MLãƒ¢ãƒ‡ãƒ«æ¨è«–ã€æœŸå¾…ãƒªã‚¿ãƒ¼ãƒ³ãƒ»ä¿¡é ¼åº¦å‡ºåŠ› |
| **Decision Engine** | ã‚·ã‚°ãƒŠãƒ«ç”Ÿæˆã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚° |
| **Risk Manager** | ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚¸ãƒ³ã‚°ã€SL/TPè¨ˆç®—ã€DDåˆ¶å¾¡ |
| **Trainer Pipeline** | å®šæœŸå†å­¦ç¿’ã€Walk-Forwardæœ€é©åŒ– |
| **Model Registry** | ãƒ¢ãƒ‡ãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã€ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ |
| **Monitoring** | ãƒ—ãƒ­ã‚»ã‚¹ç›£è¦–ã€è‡ªå‹•å¾©æ—§ã€ã‚¢ãƒ©ãƒ¼ãƒˆ |

---

## 3. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | æŠ€è¡“ | ç†ç”± |
|----------|------|------|
| **åŸ·è¡Œ** | MT5 + MQL5 EA | ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼æ¥ç¶šã€å»ºç‰ç®¡ç†ã€å®‰å…¨è£…ç½® |
| **é€šä¿¡** | ZeroMQ | ä½é…å»¶ã€åŒæ–¹å‘ã€Pythoné€£æºå®¹æ˜“ |
| **æ¨è«–** | Python 3.11+ | MLæ¨è«–ã«æœ€é©ã€ç‰¹å¾´é‡å‡¦ç†ãŒå®¹æ˜“ |
| **MLãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯** | LightGBM | é«˜é€Ÿã€é ‘å¥ã€è§£é‡ˆå¯èƒ½ |
| **å°†æ¥æ‹¡å¼µ** | PyTorch (Transformer) | ç²¾åº¦æ”¹å–„ãŒç¢ºèªã§ããŸå ´åˆ |
| **ãƒ‡ãƒ¼ã‚¿ä¿å­˜** | SQLite / Parquet | è»½é‡ã€é«˜é€Ÿã€åˆ†æã—ã‚„ã™ã„ |
| **ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©** | Windows Task Scheduler | å†å­¦ç¿’ãƒ»ç›£è¦–ã®å®šæœŸå®Ÿè¡Œ |
| **è¨­å®šç®¡ç†** | YAML | äººé–“å¯èª­ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã—ã‚„ã™ã„ |

---

## 4. MLãƒ¢ãƒ‡ãƒ«è¨­è¨ˆ

### 4.1 æ®µéšçš„ãƒ¢ãƒ‡ãƒ«å°å…¥

| Phase | ãƒ¢ãƒ‡ãƒ« | ç›®çš„ |
|-------|--------|------|
| **Phase 1** | LightGBM | ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³æ§‹ç¯‰ã€é ‘å¥æ€§ç¢ºä¿ |
| **Phase 2** | LightGBM + XGBoost ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ« | å®‰å®šæ€§å‘ä¸Š |
| **Phase 3** | + Transformer (å¿…è¦æ™‚) | ç²¾åº¦ä¸Šé™ã®è¿½æ±‚ |

### 4.2 äºˆæ¸¬ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

**ã€Œä¸ŠãŒã‚‹/ä¸‹ãŒã‚‹ã€ã§ã¯ãªãã€ã€ŒæœŸå¾…ãƒªã‚¿ãƒ¼ãƒ³ + ä¸ç¢ºå®Ÿæ€§ã€ã‚’äºˆæ¸¬**

```python
# äºˆæ¸¬ã‚¿ãƒ¼ã‚²ãƒƒãƒˆä¾‹
target = {
    "expected_return_3h": 0.0012,    # 3æ™‚é–“å¾Œã®æœŸå¾…ãƒªã‚¿ãƒ¼ãƒ³
    "expected_return_6h": 0.0018,    # 6æ™‚é–“å¾Œã®æœŸå¾…ãƒªã‚¿ãƒ¼ãƒ³
    "quantile_5": -0.0025,           # 5%åˆ†ä½ç‚¹ï¼ˆä¸‹æŒ¯ã‚Œãƒªã‚¹ã‚¯ï¼‰
    "quantile_95": 0.0035,           # 95%åˆ†ä½ç‚¹ï¼ˆä¸ŠæŒ¯ã‚Œå¯èƒ½æ€§ï¼‰
    "confidence": 0.72               # äºˆæ¸¬ã®ä¿¡é ¼åº¦
}
```

### 4.3 LightGBMã‚’æœ€åˆã«ä½¿ã†ç†ç”±

| ç‰¹æ€§ | LightGBM | LSTM/Transformer |
|------|----------|------------------|
| å°‘ãƒ‡ãƒ¼ã‚¿ã§ã®æ€§èƒ½ | â— å¼·ã„ | â–³ å¤§é‡ãƒ‡ãƒ¼ã‚¿å¿…è¦ |
| å­¦ç¿’é€Ÿåº¦ | â— é«˜é€Ÿ | â–³ é…ã„ |
| éå­¦ç¿’å¯¾ç­– | â— æ­£å‰‡åŒ–ãŒåŠ¹ã | â–³ èª¿æ•´é›£ã—ã„ |
| è§£é‡ˆæ€§ | â— ç‰¹å¾´é‡é‡è¦åº¦ | Ã— ãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ |
| é‹ç”¨è² è· | â— è»½ã„ | â–³ é‡ã„ |
| ãƒ‡ãƒãƒƒã‚° | â— å®¹æ˜“ | â–³ å›°é›£ |

---

## 5. ç‰¹å¾´é‡è¨­è¨ˆ

### 5.1 ãƒªãƒ¼ã‚¯é˜²æ­¢ã®å¤§åŸå‰‡

```
âš ï¸ çµ¶å¯¾ãƒ«ãƒ¼ãƒ«ï¼šã™ã¹ã¦ã€Œç¢ºå®šæ¸ˆã¿è¶³ã€ã‹ã‚‰ç”Ÿæˆ
   æœªç¢ºå®šè¶³ãƒ»æœªæ¥ã®é«˜å€¤å®‰å€¤ã¯çµ¶å¯¾ã«ä½¿ã‚ãªã„
```

### 5.2 ç‰¹å¾´é‡ã‚«ãƒ†ã‚´ãƒª

#### 5.2.1 ä¾¡æ ¼ç³»
| ç‰¹å¾´é‡ | èª¬æ˜ |
|--------|------|
| `log_return_1` | 1æœ¬å‰ã®ãƒ­ã‚°ãƒªã‚¿ãƒ¼ãƒ³ |
| `log_return_5` | 5æœ¬ãƒªã‚¿ãƒ¼ãƒ³ |
| `log_return_20` | 20æœ¬ãƒªã‚¿ãƒ¼ãƒ³ |
| `range_hl` | High-Low ãƒ¬ãƒ³ã‚¸ |
| `realized_vol_20` | å®Ÿç¾ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼ˆ20æœ¬ï¼‰ |
| `gap` | ã‚®ãƒ£ãƒƒãƒ— |

#### 5.2.2 ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™
| ç‰¹å¾´é‡ | èª¬æ˜ |
|--------|------|
| `ema_slope_20` | EMAå‚¾ã |
| `macd` | MACD |
| `macd_signal` | MACDã‚·ã‚°ãƒŠãƒ« |
| `rsi_14` | RSIï¼ˆ14æœŸé–“ï¼‰ |
| `atr_14` | ATRï¼ˆ14æœŸé–“ï¼‰ |
| `bollinger_width` | ãƒœãƒªãƒ³ã‚¸ãƒ£ãƒ¼å¹… |
| `adx_14` | ADXï¼ˆãƒˆãƒ¬ãƒ³ãƒ‰å¼·åº¦ï¼‰ |

#### 5.2.3 ãƒãƒ«ãƒã‚¿ã‚¤ãƒ ãƒ•ãƒ¬ãƒ¼ãƒ ï¼ˆMTFï¼‰
| ç‰¹å¾´é‡ | èª¬æ˜ |
|--------|------|
| `h1_ema_slope` | H1ã®EMAå‚¾ã |
| `h1_atr` | H1ã®ATR |
| `h4_trend_direction` | H4ã®ãƒˆãƒ¬ãƒ³ãƒ‰æ–¹å‘ |
| `d1_range_position` | D1ãƒ¬ãƒ³ã‚¸å†…ã®ä½ç½® |

#### 5.2.4 æ™‚é–“ãƒ»ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼
| ç‰¹å¾´é‡ | èª¬æ˜ |
|--------|------|
| `hour_of_day` | æ™‚é–“ï¼ˆ0-23ï¼‰ |
| `day_of_week` | æ›œæ—¥ |
| `session` | ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼ˆæ±äº¬/ãƒ­ãƒ³ãƒ‰ãƒ³/NYï¼‰ |
| `is_high_impact_hour` | é‡è¦æŒ‡æ¨™æ™‚é–“å¸¯ãƒ•ãƒ©ã‚° |

#### 5.2.5 å–å¼•ã‚³ã‚¹ãƒˆãƒ»æµå‹•æ€§
| ç‰¹å¾´é‡ | èª¬æ˜ |
|--------|------|
| `spread_current` | ç¾åœ¨ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ |
| `spread_ma_20` | ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ç§»å‹•å¹³å‡ |
| `tick_volume` | ãƒ†ã‚£ãƒƒã‚¯ãƒœãƒªãƒ¥ãƒ¼ãƒ  |

---

## 6. ãƒãƒ«ãƒã‚¿ã‚¤ãƒ ãƒ•ãƒ¬ãƒ¼ãƒ æˆ¦ç•¥

### 6.1 2æ®µãƒ•ã‚£ãƒ«ã‚¿æ–¹å¼ï¼ˆæ¨å¥¨ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Stage 1: ä¸Šä½è¶³ã§ãƒ¬ã‚¸ãƒ¼ãƒ åˆ¤å®š               â”‚
â”‚         (H4/D1ã§ãƒˆãƒ¬ãƒ³ãƒ‰/ãƒ¬ãƒ³ã‚¸/é«˜ãƒœãƒ©åˆ¤å®š)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
              è¨±å¯ã•ã‚ŒãŸãƒ¬ã‚¸ãƒ¼ãƒ ã®å ´åˆã®ã¿
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Stage 2: ä¸‹ä½è¶³ã§ã‚¨ãƒ³ãƒˆãƒªãƒ¼åˆ¤å®š             â”‚
â”‚         (M15/H1ã§å…·ä½“çš„ãªã‚·ã‚°ãƒŠãƒ«ç”Ÿæˆ)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 å¯¾è±¡é€šè²¨ãƒšã‚¢

| ãƒšã‚¢ | ç†ç”± | å„ªå…ˆåº¦ |
|------|------|--------|
| **EUR/USD** | æœ€ã‚‚æµå‹•æ€§ãŒé«˜ã„ã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ç‹­ã„ | é«˜ |
| **USD/JPY** | æµå‹•æ€§é«˜ã„ã€æ±äº¬ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§æ´»ç™º | é«˜ |
| **GBP/USD** | ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚ã‚Šã€ãƒˆãƒ¬ãƒ³ãƒ‰ãŒå‡ºã‚„ã™ã„ | ä¸­ |

### 6.3 æ™‚é–“è»¸

| æ™‚é–“è»¸ | ç”¨é€” |
|--------|------|
| **D1** | å¤§å±€è¦³ã€ãƒ¬ã‚¸ãƒ¼ãƒ åˆ¤å®š |
| **H4** | ãƒˆãƒ¬ãƒ³ãƒ‰æ–¹å‘ã€ãƒ•ã‚£ãƒ«ã‚¿ |
| **H1** | ã‚¨ãƒ³ãƒˆãƒªãƒ¼åˆ¤æ–­ |
| **M15** | ã‚¨ãƒ³ãƒˆãƒªãƒ¼ã‚¿ã‚¤ãƒŸãƒ³ã‚°ç²¾ç·»åŒ– |

---

## 7. ä¿å®ˆçš„ãƒªã‚¹ã‚¯ç®¡ç†

### 7.1 ãƒªã‚¹ã‚¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

```yaml
# config/risk.yaml

account_level:
  max_daily_loss_pct: 2.0        # æ—¥æ¬¡æœ€å¤§æå¤± 2%
  max_weekly_loss_pct: 5.0       # é€±æ¬¡æœ€å¤§æå¤± 5%
  max_drawdown_pct: 10.0         # æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³ 10%
  max_positions: 3               # æœ€å¤§åŒæ™‚ãƒã‚¸ã‚·ãƒ§ãƒ³æ•°

trade_level:
  risk_per_trade_pct: 1.0        # 1å–å¼•ã‚ãŸã‚Šãƒªã‚¹ã‚¯ 1%
  min_confidence: 0.65           # æœ€ä½ä¿¡é ¼åº¦
  max_spread_atr_ratio: 0.3      # ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰/ATRä¸Šé™

stop_loss_take_profit:
  sl_atr_multiplier: 2.0         # SL = 2 ATR
  tp_atr_multiplier: 3.0         # TP = 3 ATR (RR=1.5)
  trailing_start_atr: 1.5        # ãƒˆãƒ¬ãƒ¼ãƒªãƒ³ã‚°é–‹å§‹

emergency_stop:
  max_consecutive_losses: 5      # é€£æ•—ä¸Šé™
  pause_after_dd_pct: 5.0        # DD 5%ã§ä¸€æ™‚åœæ­¢
```

### 7.2 ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚¸ãƒ³ã‚°ï¼ˆãƒœãƒ©ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæ–¹å¼ï¼‰

```python
def calculate_position_size(
    account_balance: float,
    risk_per_trade_pct: float,
    atr: float,
    sl_atr_multiplier: float,
    pip_value: float
) -> float:
    """
    ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ™ãƒ¼ã‚¹ã®ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚ºè¨ˆç®—
    â†’ 1å–å¼•ã®ãƒªã‚¹ã‚¯ã‚’å£åº§ã®ä¸€å®š%ã«å›ºå®š
    """
    risk_amount = account_balance * (risk_per_trade_pct / 100)
    sl_pips = atr * sl_atr_multiplier
    position_size = risk_amount / (sl_pips * pip_value)
    return position_size
```

### 7.3 å–å¼•ãƒ•ã‚£ãƒ«ã‚¿

ä»¥ä¸‹ã™ã¹ã¦ã‚’æº€ãŸã™å ´åˆã®ã¿å–å¼•ï¼š

1. **ä¿¡é ¼åº¦** >= `min_confidence` (0.65)
2. **ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰** <= ATR Ã— `max_spread_atr_ratio` (0.3)
3. **DD** < `pause_after_dd_pct` (5%)
4. **é€£æ•—** < `max_consecutive_losses` (5)
5. **åŒæ™‚ãƒã‚¸ã‚·ãƒ§ãƒ³** < `max_positions` (3)
6. **å–å¼•æ™‚é–“å¸¯å†…**ï¼ˆé«˜ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆæŒ‡æ¨™æ™‚é–“å¤–ï¼‰

---

## 8. ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼è¨­è¨ˆ

### 8.1 Walk-Forwardæœ€é©åŒ–

```
ãƒ‡ãƒ¼ã‚¿æœŸé–“: 2020-01 ã€œ 2025-01 (5å¹´)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Train  â”‚ Valid  â”‚ Train  â”‚ Valid  â”‚ Train  â”‚ ...
â”‚ 12ãƒ¶æœˆ â”‚ 2ãƒ¶æœˆ  â”‚ 12ãƒ¶æœˆ â”‚ 2ãƒ¶æœˆ  â”‚ 12ãƒ¶æœˆ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“         â†“
  å­¦ç¿’     æ¤œè¨¼ï¼ˆæœªæ¥ã‚’è¦‹ãªã„ï¼‰
```

### 8.2 æ™‚ç³»åˆ—CVï¼ˆPurged K-Foldï¼‰

```
ãƒ©ãƒ™ãƒ«é‡ãªã‚ŠæœŸé–“ï¼ˆEmbargoï¼‰ã‚’è¨­ã‘ã¦ãƒªãƒ¼ã‚¯é˜²æ­¢

Fold 1: [====Train====]--gap--[==Valid==]--gap--[====Test====]
Fold 2: [====Train==========]--gap--[==Valid==]--gap--[==Test==]
```

### 8.3 è©•ä¾¡æŒ‡æ¨™

| æŒ‡æ¨™ | èª¬æ˜ | ç›®æ¨™ |
|------|------|------|
| **Profit Factor** | ç·åˆ©ç›Š / ç·æå¤± | > 1.5 |
| **Sharpe Ratio** | ãƒªã‚¹ã‚¯èª¿æ•´å¾Œãƒªã‚¿ãƒ¼ãƒ³ | > 1.0 |
| **Max Drawdown** | æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³ | < 10% |
| **Win Rate** | å‹ç‡ | > 50% |
| **Expectancy** | æœŸå¾…å€¤ï¼ˆæ‰‹æ•°æ–™è¾¼ã¿ï¼‰ | > 0 |
| **Calmar Ratio** | å¹´é–“ãƒªã‚¿ãƒ¼ãƒ³ / æœ€å¤§DD | > 1.0 |

### 8.4 ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°å¯¾ç­–

1. **ç‰¹å¾´é‡ã‚’å¢—ã‚„ã™å‰ã«**ã€å–å¼•ã‚³ã‚¹ãƒˆè¾¼ã¿ã§æ”¹å–„ãŒå†ç¾ã™ã‚‹ã‹ç¢ºèª
2. ãƒ¢ãƒ‡ãƒ«æ€§èƒ½æŒ‡æ¨™ã¯AUCç­‰ã ã‘ã§ãªãã€**æ‰‹æ•°æ–™è¾¼ã¿ã®æœŸå¾…å€¤ãƒ»æœ€å¤§DD**ã‚’é‡è¦–
3. **Walk-Forward**ã§æœªæ¥ã‚’è¦‹ãªã„æ¤œè¨¼ã‚’å¾¹åº•
4. ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯**æœ€å°é™**ã«æŠ‘ãˆã‚‹

---

## 9. 24/365è‡ªå‹•é‹ç”¨è¨­è¨ˆ

### 9.1 ãƒ—ãƒ­ã‚»ã‚¹æ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     è‡ªå®…PC (å¸¸æ™‚ç¨¼åƒ)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ MT5         â”‚ Python       â”‚ Watchdog Service        â”‚  â”‚
â”‚  â”‚ Terminal    â”‚ Inference    â”‚ (ç›£è¦–ãƒ»è‡ªå‹•å¾©æ—§)         â”‚  â”‚
â”‚  â”‚             â”‚ Service      â”‚                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Windows Task Scheduler                               â”‚   â”‚
â”‚  â”‚ - é€±æ¬¡: ãƒ¢ãƒ‡ãƒ«å†å­¦ç¿’ (æ—¥æ›œæ·±å¤œ)                        â”‚   â”‚
â”‚  â”‚ - æ—¥æ¬¡: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¬ãƒãƒ¼ãƒˆ                         â”‚   â”‚
â”‚  â”‚ - æ¯æ™‚: ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 éšœå®³å¾©æ—§ãƒ•ãƒ­ãƒ¼

```
[éšœå®³æ¤œçŸ¥] â†’ [ãƒ—ãƒ­ã‚»ã‚¹å†èµ·å‹•] â†’ [çŠ¶æ…‹åŒæœŸ] â†’ [å®‰å…¨ãƒ¢ãƒ¼ãƒ‰]
     â”‚              â”‚               â”‚            â”‚
     â”‚              â”‚               â”‚            â””â†’ æ–°è¦å–å¼•ç¦æ­¢
     â”‚              â”‚               â”‚               æ—¢å­˜SLã®ã¿ç¶­æŒ
     â”‚              â”‚               â”‚
     â”‚              â”‚               â””â†’ å»ºç‰ãƒ»æ³¨æ–‡ã®å†å–å¾—
     â”‚              â”‚
     â”‚              â””â†’ WatchdogãŒè‡ªå‹•å†èµ·å‹•
     â”‚
     â””â†’ ãƒ—ãƒ­ã‚»ã‚¹æ­»äº¡/å¿œç­”ãªã—/ã‚¨ãƒ©ãƒ¼ç‡ä¸Šæ˜‡
```

### 9.3 ãƒ¢ãƒ‡ãƒ«å†å­¦ç¿’ã‚µã‚¤ã‚¯ãƒ«

```
é€±æ¬¡ï¼ˆæ—¥æ›œæ·±å¤œï¼‰:
  1. ãƒ‡ãƒ¼ã‚¿ç¢ºå®šãƒã‚§ãƒƒã‚¯
  2. ç‰¹å¾´é‡å†ç”Ÿæˆ
  3. Walk-forwardå­¦ç¿’
  4. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³è©•ä¾¡
  5. åˆæ ¼ â†’ Model Registryã«ç™»éŒ²
  6. æœˆæ›œå–å¼•é–‹å§‹å‰ã«ãƒ¢ãƒ‡ãƒ«åˆ‡æ›¿
  7. ä¸åˆæ ¼ â†’ å‰é€±ãƒ¢ãƒ‡ãƒ«ç¶™ç¶š + ã‚¢ãƒ©ãƒ¼ãƒˆ
```

### 9.4 ç›£è¦–é …ç›®

| é …ç›® | é–¾å€¤ | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |
|------|------|------------|
| Python Service å¿œç­” | > 5ç§’ | å†èµ·å‹• |
| MT5 æ¥ç¶šçŠ¶æ…‹ | åˆ‡æ–­ | å†æ¥ç¶šè©¦è¡Œ â†’ ã‚¢ãƒ©ãƒ¼ãƒˆ |
| æ—¥æ¬¡æå¤± | > 2% | å–å¼•åœæ­¢ + ã‚¢ãƒ©ãƒ¼ãƒˆ |
| ã‚¨ãƒ©ãƒ¼ç‡ | > 10% | ã‚¢ãƒ©ãƒ¼ãƒˆ |
| ãƒ¢ãƒ‡ãƒ«äºˆæ¸¬ã®æ ¡æ­£ | ä¹–é›¢å¤§ | ã‚¢ãƒ©ãƒ¼ãƒˆ |

---

## 10. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
trade/
â”œâ”€â”€ mql5/
â”‚   â”œâ”€â”€ Experts/
â”‚   â”‚   â””â”€â”€ MLTradingEA.mq5           # åŸ·è¡ŒEAï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
â”‚   â””â”€â”€ Include/
â”‚       â”œâ”€â”€ ZeroMQ.mqh                # ZeroMQé€šä¿¡ãƒ©ãƒƒãƒ‘ãƒ¼ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
â”‚       â””â”€â”€ PositionManager.mqh       # ãƒã‚¸ã‚·ãƒ§ãƒ³ç®¡ç†ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
â”‚
â”œâ”€â”€ python/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ communication/            # é€šä¿¡ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ zmq_server.py         # ZeroMQã‚µãƒ¼ãƒãƒ¼
â”‚   â”‚   â”‚   â”œâ”€â”€ signal_service.py     # ã‚·ã‚°ãƒŠãƒ«ç”Ÿæˆã‚µãƒ¼ãƒ“ã‚¹
â”‚   â”‚   â”‚   â”œâ”€â”€ error_handling.py     # ãƒªãƒˆãƒ©ã‚¤/ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼
â”‚   â”‚   â”‚   â””â”€â”€ alerting.py           # ã‚¢ãƒ©ãƒ¼ãƒˆé€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ inference/                # æ¨è«–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ predictor.py          # ãƒ¢ãƒ‡ãƒ«æ¨è«–
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ features/                 # ç‰¹å¾´é‡ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ technical.py          # ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™
â”‚   â”‚   â”‚   â””â”€â”€ mtf.py                # ãƒãƒ«ãƒã‚¿ã‚¤ãƒ ãƒ•ãƒ¬ãƒ¼ãƒ ç‰¹å¾´é‡
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ training/                 # å­¦ç¿’ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ trainer.py            # ãƒ¢ãƒ‡ãƒ«å­¦ç¿’
â”‚   â”‚   â”‚   â”œâ”€â”€ walk_forward.py       # WFæœ€é©åŒ–
â”‚   â”‚   â”‚   â”œâ”€â”€ evaluation.py         # è©•ä¾¡ãƒ¡ãƒˆãƒªã‚¯ã‚¹
â”‚   â”‚   â”‚   â”œâ”€â”€ backtest.py           # ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ hyperopt.py           # ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–
â”‚   â”‚   â”‚   â”œâ”€â”€ registry.py           # ãƒ¢ãƒ‡ãƒ«ãƒ¬ã‚¸ã‚¹ãƒˆãƒª
â”‚   â”‚   â”‚   â”œâ”€â”€ calibration.py        # äºˆæ¸¬ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”‚   â”‚   â””â”€â”€ model_comparison.py   # ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ data/                     # ãƒ‡ãƒ¼ã‚¿ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ loader.py             # ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ‰
â”‚   â”‚   â”‚   â”œâ”€â”€ store.py              # ãƒ‡ãƒ¼ã‚¿ä¿å­˜
â”‚   â”‚   â”‚   â””â”€â”€ preprocessor.py       # å‰å‡¦ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ utils/                    # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ config.py             # è¨­å®šç®¡ç†
â”‚   â”‚       â””â”€â”€ logger.py             # ãƒ­ã‚®ãƒ³ã‚°
â”‚   â”‚
â”‚   â”œâ”€â”€ tests/                        # ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
â”‚   â”‚   â”œâ”€â”€ integration/
â”‚   â”‚   â”‚   â””â”€â”€ test_mt5_communication.py
â”‚   â”‚   â”œâ”€â”€ test_features.py
â”‚   â”‚   â”œâ”€â”€ test_training.py
â”‚   â”‚   â”œâ”€â”€ test_inference.py
â”‚   â”‚   â”œâ”€â”€ test_backtest.py
â”‚   â”‚   â”œâ”€â”€ test_registry.py
â”‚   â”‚   â”œâ”€â”€ test_zmq_server.py
â”‚   â”‚   â”œâ”€â”€ test_error_handling.py
â”‚   â”‚   â””â”€â”€ conftest.py
â”‚   â”‚
â”‚   â””â”€â”€ requirements.txt
â”‚
â”œâ”€â”€ models/                           # å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ production/
â”‚   â”‚   â””â”€â”€ latest/
â”‚   â””â”€â”€ archive/
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                          # ç”Ÿãƒ‡ãƒ¼ã‚¿
â”‚   â”œâ”€â”€ processed/                    # å‰å‡¦ç†æ¸ˆã¿
â”‚   â””â”€â”€ backtest/                     # ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆçµæœ
â”‚
â”œâ”€â”€ logs/                             # ãƒ­ã‚°
â”‚   â”œâ”€â”€ trading/
â”‚   â”œâ”€â”€ training/
â”‚   â”œâ”€â”€ alerts/                       # ã‚¢ãƒ©ãƒ¼ãƒˆãƒ­ã‚°
â”‚   â””â”€â”€ monitoring/
â”‚
â”œâ”€â”€ config/                           # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
â”‚   â”œâ”€â”€ trading.yaml                  # å–å¼•è¨­å®š
â”‚   â”œâ”€â”€ risk.yaml                     # ãƒªã‚¹ã‚¯è¨­å®š
â”‚   â””â”€â”€ model.yaml                    # ãƒ¢ãƒ‡ãƒ«è¨­å®š
â”‚
â”œâ”€â”€ scripts/                          # é‹ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆæœªå®Ÿè£…ï¼‰
â”‚   â”œâ”€â”€ start_service.bat
â”‚   â”œâ”€â”€ stop_service.bat
â”‚   â””â”€â”€ retrain.bat
â”‚
â””â”€â”€ docs/
    â””â”€â”€ DESIGN.md                     # æœ¬è¨­è¨ˆæ›¸
```

---

## 11. é–‹ç™ºãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

### Phase 1: åŸºç›¤æ§‹ç¯‰ï¼ˆ3-5æ—¥ï¼‰ âœ… å®Œäº†

- [x] ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»ä¿å­˜åŸºç›¤ (`src/data/loader.py`, `store.py`, `preprocessor.py`)
- [x] ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆãƒªãƒ¼ã‚¯é˜²æ­¢è¾¼ã¿ï¼‰ (`src/features/technical.py`, `mtf.py`)
- [x] ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆåŸºç›¤ï¼ˆWalk-Forwardï¼‰ (`src/training/backtest.py`, `walk_forward.py`)
- [x] è©•ä¾¡ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ (`src/training/evaluation.py`)

### Phase 2: MLãƒ¢ãƒ‡ãƒ«ï¼ˆ3-5æ—¥ï¼‰ âœ… å®Œäº†

- [x] LightGBMãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ (`src/training/trainer.py`)
- [x] äºˆæ¸¬ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè¨­è¨ˆ (`src/training/trainer.py`)
- [x] ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ– (`src/training/hyperopt.py`)
- [x] WFæ¤œè¨¼ã§æ€§èƒ½ç¢ºèª (`src/training/walk_forward.py`)
- [x] ãƒ¢ãƒ‡ãƒ«ãƒ¬ã‚¸ã‚¹ãƒˆãƒª (`src/training/registry.py`)
- [x] ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ (`src/training/calibration.py`)
- [x] ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒ (`src/training/model_comparison.py`)

### Phase 3: ãƒªã‚¹ã‚¯ç®¡ç†ï¼ˆ2-3æ—¥ï¼‰ âœ… å®Œäº†

- [x] ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚¸ãƒ³ã‚° (`mql5/Include/PositionManager.mqh`)
- [x] SL/TP/ãƒˆãƒ¬ãƒ¼ãƒªãƒ³ã‚° (`mql5/Experts/MLTradingEA.mq5`)
- [x] ã‚»ãƒ¼ãƒ•ã‚¬ãƒ¼ãƒ‰å®Ÿè£… (`src/inference/predictor.py`)
- [x] DDåˆ¶é™ãƒ»å–å¼•åœæ­¢æ¡ä»¶ (`config/risk.yaml`)

### Phase 4: åŸ·è¡Œé€£æºï¼ˆ2-3æ—¥ï¼‰ âœ… å®Œäº†

- [x] ZeroMQé€šä¿¡ (`src/communication/zmq_server.py`, `mql5/Include/ZeroMQ.mqh`)
- [x] MT5 EAå®Ÿè£… (`mql5/Experts/MLTradingEA.mq5`)
- [x] ã‚·ã‚°ãƒŠãƒ«â†’ç™ºæ³¨ãƒ•ãƒ­ãƒ¼ (`src/communication/signal_service.py`)
- [x] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° (`src/communication/error_handling.py`, `alerting.py`)
  - ãƒªãƒˆãƒ©ã‚¤ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆæŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•ï¼‰
  - ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼
  - æ¥ç¶šå¥å…¨æ€§ç›£è¦–
  - ã‚¢ãƒ©ãƒ¼ãƒˆé€šçŸ¥ï¼ˆãƒ¬ãƒ¼ãƒˆåˆ¶é™ä»˜ãï¼‰
  - è‡ªå‹•å†æ¥ç¶š

### Phase 5: è‡ªå‹•é‹ç”¨ï¼ˆ2-3æ—¥ï¼‰ ğŸ”„ æœªç€æ‰‹

- [ ] Watchdog/ç›£è¦–
- [ ] è‡ªå‹•å¾©æ—§
- [ ] å†å­¦ç¿’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
- [ ] ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š

### Phase 6: æœ¬ç•ªç¨¼åƒï¼ˆç¶™ç¶šï¼‰ ğŸ”„ æœªç€æ‰‹

- [ ] æ¥µå°ãƒ­ãƒƒãƒˆã§ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆ
- [ ] æ€§èƒ½ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°
- [ ] æ®µéšçš„ãƒ­ãƒƒãƒˆå¢—åŠ 
- [ ] ãƒ¢ãƒ‡ãƒ«æ”¹å–„ã‚µã‚¤ã‚¯ãƒ«

---

## 12. ãƒªã‚¹ã‚¯ã¨å¯¾ç­–

### 12.1 æŠ€è¡“çš„ãƒªã‚¹ã‚¯

| ãƒªã‚¹ã‚¯ | å¯¾ç­– |
|--------|------|
| ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒˆ | Walk-Forwardæ¤œè¨¼ã€Out-of-sampleæœŸé–“ç¢ºä¿ |
| ãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ã‚¯ | ç¢ºå®šè¶³ã®ã¿ä½¿ç”¨ã€MTFã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—å³æ ¼ç®¡ç† |
| ãƒ¢ãƒ‡ãƒ«åŠ£åŒ– | å®šæœŸå†å­¦ç¿’ã€æ€§èƒ½ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã€ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿæ§‹ |
| ã‚·ã‚¹ãƒ†ãƒ éšœå®³ | Watchdogã€è‡ªå‹•å¾©æ—§ã€å®‰å…¨ãƒ¢ãƒ¼ãƒ‰ |

### 12.2 é‹ç”¨ãƒªã‚¹ã‚¯

| ãƒªã‚¹ã‚¯ | å¯¾ç­– |
|--------|------|
| æ€¥æ¿€ãªDD | MaxDrawdownåˆ¶é™ã§è‡ªå‹•åœæ­¢ |
| é€£æ•— | é€£æ•—ä¸Šé™ã§ä¸€æ™‚åœæ­¢ |
| ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰æ‹¡å¤§ | ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ãƒ•ã‚£ãƒ«ã‚¿ |
| ç´„å®šæ‹’å¦ | ãƒªãƒˆãƒ©ã‚¤ãƒ­ã‚¸ãƒƒã‚¯ã€ãƒ­ã‚°è¨˜éŒ² |
| æ¥ç¶šæ–­ | å†æ¥ç¶šå‡¦ç†ã€ãƒã‚¸ã‚·ãƒ§ãƒ³æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ |

### 12.3 å¸‚å ´ãƒªã‚¹ã‚¯

| ãƒªã‚¹ã‚¯ | å¯¾ç­– |
|--------|------|
| ãƒ¬ã‚¸ãƒ¼ãƒ å¤‰åŒ– | ãƒ¬ã‚¸ãƒ¼ãƒ æ¤œçŸ¥ãƒ•ã‚£ãƒ«ã‚¿ã€å–å¼•ç¸®å° |
| é‡è¦æŒ‡æ¨™ç™ºè¡¨ | æ™‚é–“å¸¯ãƒ•ã‚£ãƒ«ã‚¿ |
| æµå‹•æ€§ä½ä¸‹ | ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ãƒ»ãƒœãƒªãƒ¥ãƒ¼ãƒ ãƒ•ã‚£ãƒ«ã‚¿ |

---

## 13. æˆåŠŸæŒ‡æ¨™

### çŸ­æœŸï¼ˆ1-3ãƒ¶æœˆï¼‰

- [ ] ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã§Profit Factor > 1.5
- [ ] Walk-Forwardæ¤œè¨¼ã§Sharp Ratio > 1.0
- [ ] ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆï¼ˆæ¥µå°ãƒ­ãƒƒãƒˆï¼‰ã§åˆ©ç›Š

### ä¸­æœŸï¼ˆ3-6ãƒ¶æœˆï¼‰

- [ ] æœ¬ç•ªé‹ç”¨ã§Max DD < 10%
- [ ] æœˆæ¬¡ãƒ—ãƒ©ã‚¹ã‚’3ãƒ¶æœˆç¶™ç¶š
- [ ] è‡ªå‹•å¾©æ—§ãŒæ­£å¸¸ã«æ©Ÿèƒ½

### é•·æœŸï¼ˆ6-12ãƒ¶æœˆï¼‰

- [ ] å¹´é–“ãƒªã‚¿ãƒ¼ãƒ³ãŒãƒ—ãƒ©ã‚¹
- [ ] Calmar Ratio > 1.0
- [ ] ãƒ¢ãƒ‡ãƒ«æ”¹å–„ã‚µã‚¤ã‚¯ãƒ«ãŒç¢ºç«‹

---

## 14. å‚è€ƒè³‡æ–™

- [LightGBM Documentation](https://lightgbm.readthedocs.io/)
- [MetaTrader 5 Documentation](https://www.mql5.com/en/docs)
- [ZeroMQ Guide](https://zguide.zeromq.org/)
- [Walk-Forward Analysis](https://www.investopedia.com/terms/w/walk-forward-testing.asp)

---

## æ›´æ–°å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å†…å®¹ |
|------|------------|------|
| 2026-01-26 | 1.0 | åˆç‰ˆä½œæˆ |
| 2026-01-26 | 1.1 | Phase 1-4 å®Ÿè£…å®Œäº†ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ– |
